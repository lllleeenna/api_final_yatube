# API для Yatube
Позволяет получать/отправлять в формате JSON данные о:
- Группах
- Публикациях
- Комментариях
- Подписках
- Плучать, обновлять, проверять JWT токены

Анонимные запросы к API запрещены

## Технологии:
- python 3.9
- Django 2.2
- djangorestframework 3.12.4
- PyJWT 2.1
## Как запустить проект:

Клонировать репозиторий и перейти в него в командной строке:

```
git clone https://github.com/lllleeenna/api_final_yatube.git
```

```
cd api_final_yatube
```

Cоздать и активировать виртуальное окружение:

```
python3.9 -m venv venv
```

```
source env/scripts/activate
```

Установить зависимости из файла requirements.txt:
```
pip install -r requirements.txt
```

Выполнить миграции:

```
python manage.py migrate
```

Запустить проект:

```
python manage.py runserver
```

## Примеры запросов
В проекте доступны следующие эндпойнты:

### Для работы с JWT токенами
```
/api/v1/jwt/create/
```
POST запрос с именем пользователя и паролем.
```
{
    "username": "User",
    "password": "Password"
}
```
вернет JWT токен и refresh - для обновления токена.
```
{
    "refresh": "token_refresh",
    "access": "token_string"
}
```

```
/api/v1/jwt/refresh/
```
POST запрос с token_refresh вернет новый токен.
```
{
    "access": "token_string"
}
```

```
/api/v1/jwt/verify/
```
POST запрос проверяет валидность JWT токена.

###  Для работы с публикациями
```
/api/v1/posts/
```
GET запрос вернет список всех публикаций.
```
[
    {
        "id": 1,
        "author": "User",
        "image": "http://127.0.0.1:8000/media/posts/temp.jpeg",
        "text": "1 запись обновлена еще раз обновлена",
        "pub_date": "2022-12-05T06:39:10.579986Z",
        "group": 1
    },
    {
        "id": 4,
        "author": "User",
        "image": null,
        "text": "4 запись",
        "pub_date": "2022-12-05T06:58:06.532989Z",
        "group": 2
    }
]
```
Можно ограничить количество постов.
- limit - количество публикаций
- offset - номер страницы после которой начинать выдачу

POST запрос с данными публикации
```
{
    "text": "5 запись",
    "group": 1
}
```
создает новую запись.
```
{
    "id": 5,
    "author": "User1",
    "image": null,
    "text": "5 запись",
    "pub_date": "2022-12-06T08:59:47.470180Z",
    "group": 1
}
```
Для добавления изображения, необходимо передаеть его в виде строки, закодированной в base64.


```
/api/v1/posts/{id}/
```
GET запрос вернет публикацию по id.

```
/api/v1/posts/5/
```
PUT и PUTCH(частичное обновление) запрос
```
{
    "text": "5 запись обновлена",
    "group": 1
}
```
обновит запись.
```
{
    "id": 5,
    "author": "User1",
    "image": null,
    "text": "5 запись обновлена",
    "pub_date": "2022-12-06T08:59:47.470180Z",
    "group": 1
}
```
Запись может обновить только автор публикации.

DELETE запрос удалит запись по id. Удалить запись может только автор публикации.


###  Для работы с комментариями
```
/api/v1/posts/{post_id}/comments/
```
GET запрос вернет список всех комментариев к посу post_id
POST запрос
```
/api/v1/posts/5/comments/
```
```
{
    "text": "Комментарий к пятому посту"
}
```
создаст новй комментарий.
```
{
    "id": 19,
    "author": "User1",
    "text": "Комментарий к пятому посту",
    "created": "2022-12-06T09:19:42.024854Z",
    "post": 5
}
```

```
/api/v1/posts/{post_id}/comments/{id}/
```
GET запрос вернет комментарий id к посту post_id 
PUT и PUTCH(частичное обновление) запрос
```
/api/v1/posts/5/comments/19/
```
```
{
    "text": "Комментарий к пятому посту обновлен"
}
```
обновит комментарий.
```
{
    "id": 19,
    "author": "User1",
    "text": "Комментарий к пятому посту обновлен",
    "created": "2022-12-06T09:19:42.024854Z",
    "post": 5
}
```
DELETE запрос удалит публикацию.
Изменение и удаление записи доступно только автору публикации.


###  Для работы с сообществами
```
/api/v1/groups/
```
GET запрос вернет список доступных сообществ.

```
/api/v1/groups/{id}/
```
GET запрос вернет информацию о сообществе по id


###  Для работы с подписками
```
/api/v1/follow/
```
GET запрос вернет все подписки пользователя, сделавшего запрос.

```
/api/v1/follow/?search=User
```
поиск по подпискам пользователя, сделавшего запрос.

POST запрос с 
```
{
  "following": "Username"
}
```
создает подписку на пользователя Username
